<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Animal Fest Moldova 2026</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
body { font-family: Arial; text-align:center; margin:0; padding:0; background-color:#E9E8E6; }

/* ======= Лента фото (голосование) ======= */
#vote-feed {
    display:none;
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100vh;
    background-color: rgba(233,232,230,0.95);
    flex-direction:column;
    align-items:center;
    overflow-y:scroll;
    padding-top:50px;
    z-index:10000;
}
.vote-photo {
    width:90%;
    max-width:500px;
    margin:10px 0;
    border-radius:12px;
    object-fit:cover;
    box-shadow:0 5px 15px rgba(0,0,0,0.3);
}
#vote-close {
    position:fixed;
    top:10px;
    right:10px;
    font-size:30px;
    cursor:pointer;
    z-index:10001;
    font-weight:bold;
    color:#000;
}
</style>
</head>
<body>

<!-- Основной контент -->
<div id="main-content">
    <button id="vote">Голосовать</button>
</div>

<!-- Лента голосования -->
<div id="vote-feed"></div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

// ======= Лента фото (голосование) =======
const voteFeed = document.getElementById("vote-feed");

function openVoteFeed() {
    // Создаём крестик для закрытия
    voteFeed.innerHTML = '<div id="vote-close">&times;</div>';

    // Запрашиваем фото с сервера
    fetch("/photos")
        .then(res => res.json())
        .then(photos => {
            // добавляем фото в ленту
            photos.reverse().forEach(p => {
                const img = document.createElement("img");
                img.src = p;  // p уже полный URL
                img.className = "vote-photo";
                voteFeed.appendChild(img);
            });

            // показываем ленту и скрываем основной контент
            voteFeed.style.display = "flex";
            document.getElementById("main-content").style.display = "none";

            // навешиваем закрытие по крестику
            document.getElementById("vote-close").onclick = closeVoteFeed;
        })
        .catch(err => console.error(err));
}

function closeVoteFeed() {
    voteFeed.style.display = "none";
    document.getElementById("main-content").style.display = "block";
}

// привязываем кнопку к открытию ленты
document.getElementById("vote").onclick = openVoteFeed;
</script>

</body>
</html>
