<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Moldova Pet & Farm Awards 2026</title>
</head>
<body>
    <h1>Moldova Pet & Farm Awards 2026</h1>
    <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:</p>
    <button onclick="selectCategory('–î–æ–º–∞—à–Ω–∏–µ –ø–∏—Ç–æ–º—Ü—ã')">üê∂ –î–æ–º–∞—à–Ω–∏–µ –ø–∏—Ç–æ–º—Ü—ã</button>
    <button onclick="selectCategory('–§–µ—Ä–º–µ—Ä—Å–∫–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ')">üêÑ –§–µ—Ä–º–µ—Ä—Å–∫–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ</button>
    <button onclick="selectCategory('–≠–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏–µ')">üêæ –≠–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏–µ</button>
    <button onclick="selectCategory('–ì—Ä–∞–Ω-–ø—Ä–∏')">üëë –ì—Ä–∞–Ω-–ø—Ä–∏</button>
    <button onclick="selectCategory('–ü—Ä–∏–∑ –∑—Ä–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Å–∏–º–ø–∞—Ç–∏–π')">‚ù§Ô∏è –ü—Ä–∏–∑ –∑—Ä–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Å–∏–º–ø–∞—Ç–∏–π</button>

    <div id="upload-section" style="display:none; margin-top:20px;">
        <h2>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ –≤–∞—à–µ–≥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ</h2>
        <form id="upload-form" enctype="multipart/form-data">
            <input type="file" id="photo" accept="image/*" required>
            <br><br>
            <button type="submit">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</button>
        </form>
        <p id="message"></p>
    </div>

    <!-- –§–∏–ª—å—Ç—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
    <div style="margin-top:10px;">
        <label for="category-filter">–ü–æ–∫–∞–∑–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é:</label>
        <select id="category-filter">
            <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
            <option value="–î–æ–º–∞—à–Ω–∏–µ –ø–∏—Ç–æ–º—Ü—ã">–î–æ–º–∞—à–Ω–∏–µ –ø–∏—Ç–æ–º—Ü—ã</option>
            <option value="–§–µ—Ä–º–µ—Ä—Å–∫–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ">–§–µ—Ä–º–µ—Ä—Å–∫–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ</option>
            <option value="–≠–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏–µ">–≠–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏–µ</option>
            <option value="–ì—Ä–∞–Ω-–ø—Ä–∏">–ì—Ä–∞–Ω-–ø—Ä–∏</option>
            <option value="–ü—Ä–∏–∑ –∑—Ä–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Å–∏–º–ø–∞—Ç–∏–π">–ü—Ä–∏–∑ –∑—Ä–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Å–∏–º–ø–∞—Ç–∏–π</option>
        </select>
    </div>

    <!-- –ì–ê–õ–ï–†–ï–Ø -->
    <div id="gallery" style="margin-top:20px;">
        <h2>–ì–∞–ª–µ—Ä–µ—è</h2>
        <div id="photos"></div>
    </div>

    <script>
        let selectedCategory = "";
        let username = "–ê–Ω–æ–Ω–∏–º"; // –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å input, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

        function selectCategory(category) {
            selectedCategory = category;
            document.getElementById("upload-section").style.display = "block";
            alert("–í—ã –≤—ã–±—Ä–∞–ª–∏: " + category);
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –∑–∞–≥—Ä—É–∑–∫–∏
        document.getElementById('upload-form').addEventListener('submit', function(e){
            e.preventDefault();
            let fileInput = document.getElementById('photo');
            let file = fileInput.files[0];
            if(!file) return alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª!");
            let formData = new FormData();
            formData.append('photo', file);
            formData.append('category', selectedCategory);
            formData.append('username', username);
            fetch('/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if(data.status === 'ok'){
                    document.getElementById('message').innerText = "–§–æ—Ç–æ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ! ID: " + data.photo_id;
                    fileInput.value = "";
                    loadGallery(); // –æ–±–Ω–æ–≤–ª—è–µ–º –≥–∞–ª–µ—Ä–µ—é
                } else {
                    document.getElementById('message').innerText = "–û—à–∏–±–∫–∞: " + data.message;
                }
            })
            .catch(err => {
                console.error(err);
                document.getElementById('message').innerText = "–û—à–∏–±–∫–∞ —Å–µ—Ç–∏.";
            });
        });

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥–∞–ª–µ—Ä–µ–∏
        function updateGallery(data) {
            let container = document.getElementById('photos');
            container.innerHTML = ""; // –æ—á–∏—â–∞–µ–º –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º
            data.forEach(photo => {
                let img = document.createElement('img');
                img.src = '/static/uploads/' + photo.filename;
                img.style.width = '150px';
                img.style.margin = '5px';
                container.appendChild(img);
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –≥–∞–ª–µ—Ä–µ–∏
        function loadGallery() {
            fetch('/photos')
            .then(res => res.json())
            .then(updateGallery)
            .catch(err => console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–∞–ª–µ—Ä–µ–∏:', err));
        }

        // –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        document.getElementById('category-filter').addEventListener('change', function() {
            let selected = this.value;
            if(selected === "") {
                fetch('/photos')
                .then(res => res.json())
                .then(updateGallery)
                .catch(err => console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–∞–ª–µ—Ä–µ–∏:', err));
            } else {
                fetch('/photos/' + encodeURIComponent(selected))
                .then(res => res.json())
                .then(updateGallery)
                .catch(err => console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–∞–ª–µ—Ä–µ–∏:', err));
            }
        });

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥–∞–ª–µ—Ä–µ—é –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            loadGallery();
        };
    </script>
</body>
</html>
