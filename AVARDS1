<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Moldova Pet & Farm Awards 2026</title>
<style>
body {
    font-family: 'Segoe UI', sans-serif;
    background: #f5f7fa;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
}
header {
    background: #ff6b81;
    color: white;
    width: 100%;
    padding: 15px;
    text-align: center;
    font-size: 1.5em;
    font-weight: bold;
    box-shadow: 0 3px 6px rgba(0,0,0,0.1);
}
.category-filter {
    margin: 15px 0;
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    justify-content: center;
}
.category-filter button {
    background: #fff;
    border: 2px solid #ff6b81;
    color: #ff6b81;
    border-radius: 25px;
    padding: 8px 16px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
}
.category-filter button:hover {
    background: #ff6b81;
    color: white;
}
.vote-feed {
    display: flex;
    flex-direction: column;
    gap: 20px;
    width: 95%;
    max-width: 400px;
    margin-bottom: 20px;
}
.vote-item {
    background: white;
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    text-align: center;
    transition: transform 0.2s;
}
.vote-item:hover {
    transform: scale(1.02);
}
.vote-item img {
    width: 100%;
    display: block;
}
.vote-buttons {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 10px;
    gap: 10px;
}
.vote-buttons button {
    font-size: 1.2em;
    background: #ff6b81;
    color: white;
    border: none;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    cursor: pointer;
    transition: all 0.2s;
}
.vote-buttons button:hover {
    transform: scale(1.2);
}
.vote-counter {
    font-weight: bold;
    font-size: 1.2em;
    margin-bottom: 5px;
}
#upload-section {
    margin-top: 20px;
}
#upload-section input, #upload-section button {
    padding: 8px;
    font-size: 1em;
}
#message {
    margin-top: 10px;
    font-weight: bold;
    color: #ff6b81;
}
</style>
</head>
<body>
<header>Moldova Pet & Farm Awards 2026</header>

<div class="category-filter">
    <button onclick="selectCategory('–î–æ–º–∞—à–Ω–∏–µ –ø–∏—Ç–æ–º—Ü—ã')">üê∂ –î–æ–º–∞—à–Ω–∏–µ –ø–∏—Ç–æ–º—Ü—ã</button>
    <button onclick="selectCategory('–§–µ—Ä–º–µ—Ä—Å–∫–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ')">üêÑ –§–µ—Ä–º–µ—Ä—Å–∫–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ</button>
    <button onclick="selectCategory('–≠–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏–µ')">üêæ –≠–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏–µ</button>
    <button onclick="selectCategory('–ì—Ä–∞–Ω-–ø—Ä–∏')">üëë –ì—Ä–∞–Ω-–ø—Ä–∏</button>
    <button onclick="selectCategory('–ü—Ä–∏–∑ –∑—Ä–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Å–∏–º–ø–∞—Ç–∏–π')">‚ù§Ô∏è –ü—Ä–∏–∑ –∑—Ä–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Å–∏–º–ø–∞—Ç–∏–π</button>
</div>

<div id="upload-section" style="display:none;">
    <h2>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ –≤–∞—à–µ–≥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ</h2>
    <form id="upload-form" enctype="multipart/form-data">
        <input type="file" id="photo" accept="image/*" required>
        <br><br>
        <button type="submit">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</button>
    </form>
    <p id="message"></p>
</div>

<div id="vote-feed" class="vote-feed">
    <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ —Ñ–æ—Ç–æ —Å ‚ù§Ô∏è –∏ —Å—á—ë—Ç—á–∏–∫–æ–º -->
</div>

<script>
let selectedCategory = "";
let username = "–ê–Ω–æ–Ω–∏–º";
let votedPhotos = {};

function selectCategory(category) {
    selectedCategory = category;
    document.getElementById("upload-section").style.display = "block";
    alert("–í—ã –≤—ã–±—Ä–∞–ª–∏: " + category);
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –∑–∞–≥—Ä—É–∑–∫–∏
document.getElementById('upload-form').addEventListener('submit', function(e){
    e.preventDefault();
    let fileInput = document.getElementById('photo');
    let file = fileInput.files[0];
    if(!file) return alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª!");
    let formData = new FormData();
    formData.append('photo', file);
    formData.append('category', selectedCategory);
    formData.append('username', username);
    fetch('/upload', { method: 'POST', body: formData })
    .then(response => response.json())
    .then(data => {
        if(data.status === 'ok'){
            document.getElementById('message').innerText = "–§–æ—Ç–æ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ! ID: " + data.photo_id;
            fileInput.value = "";
            loadVoteFeed();
        } else {
            document.getElementById('message').innerText = "–û—à–∏–±–∫–∞: " + data.message;
        }
    })
    .catch(err => {
        console.error(err);
        document.getElementById('message').innerText = "–û—à–∏–±–∫–∞ —Å–µ—Ç–∏.";
    });
});

// –õ–µ–Ω—Ç–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è —Å ‚ù§Ô∏è –∏ —Å—á—ë—Ç—á–∏–∫–æ–º
function loadVoteFeed(categoryFilter = "") {
    let url = categoryFilter ? '/photos/' + encodeURIComponent(categoryFilter) : '/photos';
    fetch(url)
    .then(res => res.json())
    .then(data => {
        let feed = document.getElementById('vote-feed');
        feed.innerHTML = "";
        let fragment = document.createDocumentFragment();
        data.forEach(photo => {
            let div = document.createElement('div');
            div.className = 'vote-item';
            div.dataset.id = photo.id;

            let img = document.createElement('img');
            img.src = '/static/uploads/' + photo.filename;
            div.appendChild(img);

            let counter = document.createElement('div');
            counter.className = 'vote-counter';
            counter.innerText = '0 ‚ù§Ô∏è';
            div.appendChild(counter);

            let btnDiv = document.createElement('div');
            btnDiv.className = 'vote-buttons';
            let upBtn = document.createElement('button');
            upBtn.innerText = '‚ù§Ô∏è';
            upBtn.className = 'vote-button';
            btnDiv.appendChild(upBtn);
            div.appendChild(btnDiv);

            fragment.appendChild(div);
        });
        feed.appendChild(fragment);
    })
    .catch(err => console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è:', err));
}

// –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤
document.getElementById('vote-feed').addEventListener('click', function(e){
    if(e.target.classList.contains('vote-button')){
        let parent = e.target.closest('.vote-item');
        let photoId = parent.dataset.id;
        if(votedPhotos[photoId]){
            alert("–í—ã —É–∂–µ –≥–æ–ª–æ—Å–æ–≤–∞–ª–∏ –∑–∞ —ç—Ç–æ —Ñ–æ—Ç–æ!");
            return;
        }
        let counter = parent.querySelector('.vote-counter');
        let count = parseInt(counter.innerText.split(' ')[0]) + 1;
        counter.innerText = count + ' ‚ù§Ô∏è';
        votedPhotos[photoId] = true;
    }
});

window.onload = function() {
    loadVoteFeed();
};
</script>

</body>
</html>
