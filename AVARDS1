// --- ID игрока ---
let playerId = null;

// Функция, которая ждёт инициализацию Telegram WebApp
function waitForTelegramInit(retries = 20) {
    if (window.Telegram && window.Telegram.WebApp) {
        const tg = window.Telegram.WebApp;
        if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
            playerId = tg.initDataUnsafe.user.id;
            console.log("Telegram ID:", playerId);
            initApp(); // старт игры
        } else {
            alert("Ошибка: нет данных пользователя Telegram");
        }
    } else if (retries > 0) {
        // Ждём 200 мс и пробуем снова
        setTimeout(() => waitForTelegramInit(retries - 1), 200);
    } else {
        alert("Ошибка: откройте через Telegram WebApp");
    }
}

// Запускаем проверку
waitForTelegramInit();

function initApp() {
    showSplashThenMap();
}
