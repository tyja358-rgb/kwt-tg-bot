  GNU nano 6.2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /home/Moldova2026/mysite/templates/index.html                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Moldova Pet & Farm Awards 2026</title>
    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ª–µ–Ω—Ç—ã –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è */
        #vote-feed {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
        }
        .vote-item {
            width: 90vw;
            max-width: 400px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
        }
        .vote-item img {
            width: 100%;
            border-radius: 10px;
        }
        .vote-buttons {
            margin-top: 10px;
        }
        .vote-buttons button {
            margin: 0 10px;
            padding: 8px 16px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <h1>Moldova Pet & Farm Awards 2026</h1>
    <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:</p>
    <button onclick="selectCategory('–î–æ–º–∞—à–Ω–∏–µ –ø–∏—Ç–æ–º—Ü—ã')">üê∂ –î–æ–º–∞—à–Ω–∏–µ –ø–∏—Ç–æ–º—Ü—ã</button>
    <button onclick="selectCategory('–§–µ—Ä–º–µ—Ä—Å–∫–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ')">üêÑ –§–µ—Ä–º–µ—Ä—Å–∫–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ</button>
    <button onclick="selectCategory('–≠–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏–µ')">üêæ –≠–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏–µ</button>
    <button onclick="selectCategory('–ì—Ä–∞–Ω-–ø—Ä–∏')">üëë –ì—Ä–∞–Ω-–ø—Ä–∏</button>
    <button onclick="selectCategory('–ü—Ä–∏–∑ –∑—Ä–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Å–∏–º–ø–∞—Ç–∏–π')">‚ù§Ô∏è –ü—Ä–∏–∑ –∑—Ä–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Å–∏–º–ø–∞—Ç–∏–π</button>
    <div id="upload-section" style="display:none; margin-top:20px;">
        <h2>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ –≤–∞—à–µ–≥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ</h2>
        <form id="upload-form" enctype="multipart/form-data">
            <input type="file" id="photo" accept="image/*" required>
            <br><br>
            <button type="submit">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</button>
        </form>
        <p id="message"></p>
    </div>
    <!-- –§–∏–ª—å—Ç—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
    <div style="margin-top:10px;">
        <label for="category-filter">–ü–æ–∫–∞–∑–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é:</label>
        <select id="category-filter">
            <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
            <option value="–î–æ–º–∞—à–Ω–∏–µ –ø–∏—Ç–æ–º—Ü—ã">–î–æ–º–∞—à–Ω–∏–µ –ø–∏—Ç–æ–º—Ü—ã</option>
            <option value="–§–µ—Ä–º–µ—Ä—Å–∫–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ">–§–µ—Ä–º–µ—Ä—Å–∫–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ</option>
            <option value="–≠–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏–µ">–≠–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏–µ</option>
            <option value="–ì—Ä–∞–Ω-–ø—Ä–∏">–ì—Ä–∞–Ω-–ø—Ä–∏</option>
            <option value="–ü—Ä–∏–∑ –∑—Ä–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Å–∏–º–ø–∞—Ç–∏–π">–ü—Ä–∏–∑ –∑—Ä–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Å–∏–º–ø–∞—Ç–∏–π</option>
        </select>
    </div>
    <!-- –ì–ê–õ–ï–†–ï–Ø -->
    <div id="gallery" style="display:none;margin-top:20px;">
        <h2>–ì–∞–ª–µ—Ä–µ—è</h2>
        <div id="photos"></div>
    </div>
    <!-- –õ–µ–Ω—Ç–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è -->
    <div id="vote-section">
        <h2>–ì–æ–ª–æ—Å–æ–≤–∞—Ç—å</h2>
        <div id="vote-feed"></div>
    </div>
<script>
let selectedCategory = "";
let username = "–ê–Ω–æ–Ω–∏–º";
let votedPhotos = {};
function selectCategory(category) {
    selectedCategory = category;
    document.getElementById("upload-section").style.display = "block";
    alert("–í—ã –≤—ã–±—Ä–∞–ª–∏: " + category);
}
// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –∑–∞–≥—Ä—É–∑–∫–∏
document.getElementById('upload-form').addEventListener('submit', function(e){
    e.preventDefault();
    let fileInput = document.getElementById('photo');
    let file = fileInput.files[0];
    if(!file) return alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª!");
    let formData = new FormData();
    formData.append('photo', file);
    formData.append('category', selectedCategory);
    formData.append('username', username);
    fetch('/upload', { method: 'POST', body: formData })
    .then(response => response.json())
    .then(data => {
        if(data.status === 'ok'){
            document.getElementById('message').innerText = "–§–æ—Ç–æ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ! ID: " + data.photo_id;
            fileInput.value = "";
            loadGallery();
            loadVoteFeed();
        } else {
            document.getElementById('message').innerText = "–û—à–∏–±–∫–∞: " + data.message;
        }
    })
    .catch(err => {
        console.error(err);
        document.getElementById('message').innerText = "–û—à–∏–±–∫–∞ —Å–µ—Ç–∏.";
    });
});
// –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥–∞–ª–µ—Ä–µ–∏
function updateGallery(data) {
    let container = document.getElementById('photos');
    container.innerHTML = "";
    data.forEach(photo => {
        let img = document.createElement('img');
        img.src = '/static/uploads/' + photo.filename;
        img.style.width = '150px';
        img.style.margin = '5px';
        container.appendChild(img);
    });
}
function loadGallery() {
    fetch('/photos')
    .then(res => res.json())
    .then(updateGallery)
    .catch(err => console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–∞–ª–µ—Ä–µ–∏:', err));
}
// –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
document.getElementById('category-filter').addEventListener('change', function() {
    let selected = this.value;
    if(selected === "") {
        fetch('/photos')
        .then(res => res.json())
        .then(updateGallery)
        .catch(err => console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–∞–ª–µ—Ä–µ–∏:', err));
        loadVoteFeed();
    } else {
        fetch('/photos/' + encodeURIComponent(selected))
        .then(res => res.json())
        .then(updateGallery)
        .catch(err => console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–∞–ª–µ—Ä–µ–∏:', err));
        loadVoteFeed(selected);
    }
});
// –õ–µ–Ω—Ç–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è —Å ‚ù§Ô∏è –∏ —Å—á—ë—Ç—á–∏–∫–æ–º (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ)
function loadVoteFeed(categoryFilter = "") {
    let url = categoryFilter ? '/photos/' + encodeURIComponent(categoryFilter) : '/photos';
    fetch(url)
    .then(res => res.json())
    .then(data => {
        let feed = document.getElementById('vote-feed');
        feed.innerHTML = "";
        let fragment = document.createDocumentFragment(); // –∏—Å–ø–æ–ª—å–∑—É–µ–º fragment –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –≤—Å—Ç–∞–≤–∫–∏
        data.forEach(photo => {
            let div = document.createElement('div');
            div.className = 'vote-item';
            div.dataset.id = photo.id; // id —Ñ–æ—Ç–æ
            let img = document.createElement('img');
            img.src = '/static/uploads/' + photo.filename;
            div.appendChild(img);
            // –°—á—ë—Ç—á–∏–∫ —Å–≤–µ—Ä—Ö—É
            let counter = document.createElement('div');
            counter.style.marginBottom = '5px';
            counter.style.fontWeight = 'bold';
            counter.innerText = '0 ‚ù§Ô∏è';
            counter.className = 'vote-counter';
            div.appendChild(counter);
            // –ö–Ω–æ–ø–∫–∞ ‚ù§Ô∏è
            let btnDiv = document.createElement('div');
            btnDiv.className = 'vote-buttons';
            let upBtn = document.createElement('button');
            upBtn.innerText = '‚ù§Ô∏è';
            upBtn.className = 'vote-button';
            btnDiv.appendChild(upBtn);
            div.appendChild(btnDiv);
            fragment.appendChild(div);
        });
        feed.appendChild(fragment);
    })
    .catch(err => console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è:', err));
}
// –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∏–∫–æ–≤ –ø–æ ‚ù§Ô∏è
document.getElementById('vote-feed').addEventListener('click', function(e){
    if(e.target.classList.contains('vote-button')){
        let parent = e.target.closest('.vote-item');
        let photoId = parent.dataset.id;
        if(votedPhotos[photoId]){
            alert("–í—ã —É–∂–µ –≥–æ–ª–æ—Å–æ–≤–∞–ª–∏ –∑–∞ —ç—Ç–æ —Ñ–æ—Ç–æ!");
            return;
        }
        let counter = parent.querySelector('.vote-counter');
        let count = parseInt(counter.innerText.split(' ')[0]) + 1;
        counter.innerText = count + ' ‚ù§Ô∏è';
        votedPhotos[photoId] = true;
    }
});
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
window.onload = function() {
    loadGallery();
    loadVoteFeed();
};
</script>
