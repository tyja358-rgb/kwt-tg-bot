// ===== –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ—á–µ–∫ =====
function generatePoints() {
    points = [];
    const TOTAL_POINTS = 50;
    const COLORS = ['#00ff99', '#ffd700', '#ff5555', '#00aaff', '#cc66ff'];

    for (let i = 0; i < TOTAL_POINTS; i++) {
        // —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ç–æ—á–∫–∏ –æ—Ç 100 –¥–æ 3500 –º–µ—Ç—Ä–æ–≤
        const distMeters = 100 + Math.random() * 3400; // 100..3500
        const distDeg = distMeters / 111320; // –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –≥—Ä–∞–¥—É—Å—ã
        const angle = Math.random() * Math.PI * 2; // —Å–ª—É—á–∞–π–Ω—ã–π —É–≥–æ–ª
        const lat = baseLat + distDeg * Math.cos(angle);
        const lng = baseLng + distDeg * Math.sin(angle);

        // —Å–æ–∑–¥–∞–µ–º –º–∞—Ä–∫–µ—Ä
        const marker = L.circleMarker([lat, lng], {
            radius: 6,
            color: COLORS[i % COLORS.length],
            fillOpacity: 0.9
        }).addTo(map);

        const point = {
            lat,
            lng,
            marker,
            collected: false,
            adsViewed: 0
        };

        // —Ä–∞—Å—á–µ—Ç –º–æ—â–Ω–æ—Å—Ç–∏ –∏ —Ä–µ–∫–ª–∞–º—ã
        point.power = calculatePower(distMeters);
        point.adsRequired = calculateAds(lat, lng); // —Ç–µ–ø–µ—Ä—å –ø–æ —Ä–µ–∞–ª—å–Ω–æ–º—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é

        // üî• –õ–æ–≥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        console.log(`–¢–æ—á–∫–∞ ${i + 1}: –¥–∏—Å—Ç–∞–Ω—Ü–∏—è = ${distMeters.toFixed(1)} –º, —Ä–µ–∫–ª–∞–º—ã = ${point.adsRequired}, –º–æ—â–Ω–æ—Å—Ç—å = ${point.power.toFixed(1)}`);

        points.push(point);

        // –∫–ª–∏–∫ –ø–æ —Ç–æ—á–∫–µ
        marker.on('click', () => openPointModal(point));
    }
}

// ===== –†–∞—Å—á–µ—Ç —Ä–µ–∫–ª–∞–º—ã =====
function calculateAds(pointLat, pointLng) {
    const dist = distance(playerLat, playerLng, pointLat, pointLng);
    return Math.ceil(dist / 100); // 100 –º = 1 —Ä–µ–∫–ª–∞–º–∞, 101-200 –º = 2 —Ä–µ–∫–ª–∞–º—ã –∏ —Ç.–¥.
}
