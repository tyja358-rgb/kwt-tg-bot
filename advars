// ===== –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ—á–µ–∫ =====
function generatePoints() {
    points = [];
    const TOTAL_POINTS = 50;
    const COLORS = ['#00ff99', '#ffd700', '#ff5555', '#00aaff', '#cc66ff'];

    for (let i = 0; i < TOTAL_POINTS; i++) {
        // —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ç–æ—á–∫–∏: –æ—Ç 100 –¥–æ 3500 –º–µ—Ç—Ä–æ–≤
        const distMeters = 100 + Math.random() * 3400; // 100..3500
        const distDeg = distMeters / 111320; // –ø–µ—Ä–µ–≤–æ–¥ –≤ –≥—Ä–∞–¥—É—Å—ã
        const angle = Math.random() * Math.PI * 2; // —Å–ª—É—á–∞–π–Ω—ã–π —É–≥–æ–ª
        const lat = baseLat + distDeg * Math.cos(angle);
        const lng = baseLng + distDeg * Math.sin(angle);

        // —Å–æ–∑–¥–∞—ë–º –º–∞—Ä–∫–µ—Ä
        const marker = L.circleMarker([lat, lng], {
            radius: 6,
            color: COLORS[i % COLORS.length],
            fillOpacity: 0.9
        }).addTo(map);

        // –æ–±—ä–µ–∫—Ç —Ç–æ—á–∫–∏
        const point = {
            lat,
            lng,
            marker,
            collected: false,
            adsViewed: 0
        };

        // —Ä–∞—Å—á—ë—Ç –º–æ—â–Ω–æ—Å—Ç–∏
        point.power = calculatePower(distMeters);

        // —Ä–∞—Å—á—ë—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–µ–∫–ª–∞–º—ã (100–º = 1 —Ä–µ–∫–ª–∞–º–∞, –æ–∫—Ä—É–≥–ª—è–µ–º –≤–≤–µ—Ä—Ö)
        point.adsRequired = Math.ceil(distMeters / 100);

        // üî• –ª–æ–≥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        console.log(`–¢–æ—á–∫–∞ ${i + 1}: –¥–∏—Å—Ç–∞–Ω—Ü–∏—è = ${distMeters.toFixed(1)} –º, —Ä–µ–∫–ª–∞–º—ã = ${point.adsRequired}, –º–æ—â–Ω–æ—Å—Ç—å = ${point.power}`);

        points.push(point);

        // –∫–ª–∏–∫ –ø–æ —Ç–æ—á–∫–µ
        marker.on('click', () => openPointModal(point));
    }
}

// ===== –†–∞—Å—á—ë—Ç –º–æ—â–Ω–æ—Å—Ç–∏ =====
function calculatePower(distMeters) {
    if (distMeters < 100) return 0;
    const hundreds = Math.floor((distMeters - 1) / 100);
    return hundreds * 4; // –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥—ã–µ 100–º = 4 –≤–∞—Ç—Ç–∞
}
